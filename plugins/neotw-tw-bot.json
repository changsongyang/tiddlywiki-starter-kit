{
    "title": "$:/plugins/oeyoews/neotw-tw-bot",
    "description": "快速记录下你的想法",
    "author": "oeyoews",
    "version": "0.0.1",
    "core-version": ">=5.3.0",
    "type": "application/json",
    "parent-plugin": "$:/plugins/oeyoews/neotw",
    "plugin-type": "plugin",
    "name": "Neotw Tw Bot",
    "dependents": "$:/plugins/oeyoews/tiddlywiki-tailwindcss-plus",
    "list": "readme",
    "text": "{\"tiddlers\":{\"$:/plugins/oeyoews/neotw-tw-bot/Action\":{\"title\":\"$:/plugins/oeyoews/neotw-tw-bot/Action\",\"tags\":\"$:/tags/StartupAction/PostRender\",\"text\":\"<$list filter=\\\"[{$:/info/url/search}match[?layout=neotw-tw-bot]]\\\">\\n  <$action-setfield $tiddler=\\\"$:/layout\\\" text=\\\"$:/plugins/oeyoews/neotw-tw-bot/Layout\\\"/>\\n</$list>\"},\"$:/plugins/oeyoews/neotw-tw-bot/Layout\":{\"title\":\"$:/plugins/oeyoews/neotw-tw-bot/Layout\",\"tags\":\"$:/tags/Layout\",\"name\":\"{{$:/plugins/oeyoews/neotw-tw-bot/icon}}\",\"description\":\"{{$:/plugins/oeyoews/neotw-tw-bot/readme!!description}}\",\"text\":\"\\\\import [[$:/core/ui/PageMacros]] [all[shadows+tiddlers]tag[$:/tags/Macro]!has[draft.of]]\\n\\n<$vars\\n\\ttv-config-toolbar-icons={{$:/config/Toolbar/Icons}}\\n\\ttv-config-toolbar-text={{$:/config/Toolbar/Text}}\\n\\ttv-config-toolbar-class={{$:/config/Toolbar/ButtonClass}}\\n\\ttv-enable-drag-and-drop={{$:/config/DragAndDrop/Enable}}\\n\\ttv-show-missing-links={{$:/config/MissingLinks}}\\n\\tstoryviewTitle={{$:/view}}\\n\\tlanguageTitle={{{ [{$:/language}get[name]] }}}>\\n\\n<div class=\\\"prose max-w-none prose-indigo m-auto sm:w-auto md:w-2/3\\\">\\n  {{{ [[$:/plugins/oeyoews/neotw-tw-bot/readme]] ||$:/core/ui/ViewTemplate }}}\\n</div>\"},\"$:/plugins/oeyoews/neotw-tw-bot/readme\":{\"title\":\"$:/plugins/oeyoews/neotw-tw-bot/readme\",\"description\":\"neotw-tw-bot\",\"text\":\"{{$:/languages/neotw-tw-bot/readme}}\\n\"},\"$:/languages/neotw-tw-bot/readme\":{\"title\":\"$:/languages/neotw-tw-bot/readme\",\"text\":\"<div class=\\\"prose max-w-none prose-indigo\\\">\\n\\n* [[Source|https://github.com/oeyoews/neotw/tree/main/plugins/oeyoews/neotw-tw-bot]]\\n\\n!! Usage\\n\\n```\\n<$tw-bot />\\n```\\n\\n<$tw-bot />\\n\\n!! 依赖插件\\n\\n* tailwindcss: 样式依赖\\n* swal2: 通知依赖\\n\\n!! TODO\\n\\n* 想法条目的自动检索\\n\\n---\\n\\n<$button class=\\\"bg-rose-400 p-2 rounded\\\">\\n  delete tw-bot created tiddlers\\n  <$action-deletetiddler $filter=\\\"[prefix[tw-bot/messages/]creator[tw-bot]]\\\"/>\\n</$button>\\n\\n</div>\"},\"$:/plugins/oeyoews/neotw-tw-bot/send.svg\":{\"title\":\"$:/plugins/oeyoews/neotw-tw-bot/send.svg\",\"text\":\"<svg class=\\\"fill-gray-300\\\" stroke=\\\"currentColor\\\" fill=\\\"currentColor\\\" stroke-width=\\\"0\\\" t=\\\"1569683742680\\\" viewBox=\\\"0 0 1024 1024\\\" version=\\\"1.1\\\" height=\\\"1em\\\" width=\\\"1em\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><defs></defs><path d=\\\"M931.4 498.9L94.9 79.5c-3.4-1.7-7.3-2.1-11-1.2-8.5 2.1-13.8 10.7-11.7 19.3l86.2 352.2c1.3 5.3 5.2 9.6 10.4 11.3l147.7 50.7-147.6 50.7c-5.2 1.8-9.1 6-10.3 11.3L72.2 926.5c-0.9 3.7-0.5 7.6 1.2 10.9 3.9 7.9 13.5 11.1 21.5 7.2l836.5-417c3.1-1.5 5.6-4.1 7.2-7.1 3.9-8 0.7-17.6-7.2-21.6zM170.8 826.3l50.3-205.6 295.2-101.3c2.3-0.8 4.2-2.6 5-5 1.4-4.2-0.8-8.7-5-10.2L221.1 403 171 198.2l628 314.9-628.2 313.2z\\\"></path></svg>\\n\",\"type\":\"image/svg+xml\"},\"$:/plugins/oeyoews/neotw-tw-bot/sendmessage.js\":{\"title\":\"$:/plugins/oeyoews/neotw-tw-bot/sendmessage.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-tw-bot/sendmessage.js\\ntype: application/javascript\\nmodule-type: library\\n\\n// 配置UI\\n// ...\\n\\n\\\\*/\\nmodule.exports = function twBot() {\\n  // 直接使用fakeDocument会报错\\n  const form = document.createElement(\\\"form\\\");\\n  form.classList.add(\\n    \\\"p-2\\\",\\n    \\\"flex\\\",\\n    \\\"justify-between\\\",\\n    \\\"max-w-xl\\\",\\n    \\\"mx-auto\\\",\\n    \\\"border\\\",\\n    \\\"border-2\\\",\\n    \\\"rounded\\\"\\n  );\\n\\n  const button = document.createElement(\\\"button\\\");\\n\\n  const sendIcon = $tw.wiki.getTiddlerText(\\n    \\\"$:/plugins/oeyoews/neotw-tw-bot/send.svg\\\"\\n  );\\n  button.innerHTML = sendIcon;\\n  button.classList.add(\\n    \\\"p-2\\\",\\n    \\\"mx-2\\\",\\n    \\\"bg-transparent\\\",\\n    \\\"hover:fill-green-700\\\",\\n    \\\"scale-125\\\"\\n  );\\n  button.title = \\\"send\\\";\\n  const inputMessage = document.createElement(\\\"input\\\");\\n  inputMessage.classList.add(\\n    \\\"w-full\\\",\\n    \\\"mx-2\\\",\\n    \\\"border-none\\\",\\n    \\\"placeholder-gray-300\\\"\\n  );\\n  inputMessage.placeholder = \\\"任何想法 ...\\\";\\n  form.appendChild(inputMessage);\\n  form.appendChild(button);\\n\\n  form.addEventListener(\\\"submit\\\", (e) => {\\n    e.preventDefault();\\n    sentMessage();\\n  });\\n  button.addEventListener(\\\"click\\\", sentMessage);\\n\\n  const timestamp = new Date().toISOString().replace(/\\\\D/g, \\\"\\\");\\n\\n  const options = {\\n    created: timestamp,\\n    modified: timestamp,\\n    creator: \\\"tw-bot\\\",\\n  };\\n\\n  function sentMessage() {\\n    // create new tiddler\\n    $tw.wiki.addTiddler({\\n      title: `tw-bot/messages/${timestamp}`,\\n      text: inputMessage.value,\\n      tags: \\\"想法\\\",\\n      ...options,\\n    });\\n    // 统计当天记录的想法数量\\n    const count = $tw.wiki.filterTiddlers(`[tag[想法]days[-1]]`).length;\\n    Swal.fire({\\n      icon: \\\"success\\\",\\n      title: \\\"想法记录成功\\\",\\n      text: `这是你今天的第${count}条想法`,\\n      showConfirmButton: false,\\n      timer: 1500,\\n      toast: true,\\n      position: \\\"top-end\\\",\\n    });\\n  }\\n  return form;\\n};\\n\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/neotw-tw-bot/widget.js\":{\"title\":\"$:/plugins/oeyoews/neotw-tw-bot/widget.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-tw-bot/widget.js\\ntype: application/javascript\\nmodule-type: widget\\n\\nneotw-tw-bot widget\\n\\n\\\\*/\\n(function () {\\n  /*jslint node: true, browser: true */\\n  /*global $tw: false */\\n  \\\"use strict\\\";\\n  // 是$:/plugins/oeyoews/neotw-tw-bot/sendmessage.js 的简写, 和真实文件路径无关, 但最好相同, 方便编辑器识别, 就不用写.js 后缀\\n  const twBot = require(\\\"./sendmessage\\\");\\n\\n  const Widget = require(\\\"$:/core/modules/widgets/widget.js\\\").widget;\\n\\n  class TwBot extends Widget {\\n    constructor(parseTreeNode, options) {\\n      super(parseTreeNode, options);\\n      this.virtualRoot = null;\\n    }\\n\\n    render(parent, nextSibling) {\\n      if (!$tw.browser) return;\\n      this.virtualRoot = twBot();\\n\\n      this.parentDomNode = parent;\\n      this.computeAttributes();\\n      this.execute();\\n\\n      parent.insertBefore(this.virtualRoot, nextSibling);\\n      this.domNodes.push(this.virtualRoot);\\n    }\\n\\n    refresh() {\\n      this.refreshSelf();\\n    }\\n  }\\n\\n  exports[\\\"tw-bot\\\"] = TwBot;\\n})();\\n\",\"type\":\"application/javascript\",\"module-type\":\"widget\"}}}"
}