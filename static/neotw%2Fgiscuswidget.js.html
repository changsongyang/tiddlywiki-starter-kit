<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="generator" content="TiddlyWiki" />
<meta name="tiddlywiki-version" content="5.2.3" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="mobile-web-app-capable" content="yes"/>
<meta name="format-detection" content="telephone=no">
<link id="faviconLink" rel="shortcut icon" href="favicon.ico">
<link rel="stylesheet" href="static.css">
<title>neotw/giscuswidget.js: 
 Neotw
 — A modern notebook based on TiddlyWiki5</title>
</head>
<body class="tc-body">
<p><div class="tc-static-alert"><div class="tc-static-alert-inner" style="align:center">This page is part of a static HTML representation of the ~TiddlyWiki at <a class="tc-tiddlylink-external" href="https://neotw.netlify.app" rel="noopener noreferrer" target="_blank">https://neotw.netlify.app</a> </div></div></p>
<section class="tc-story-river tc-static-story-river">
<p><div class="tc-tiddler-frame tc-tiddler-view-frame tc-tiddler-exists " data-tags="" data-tiddler-title="neotw/giscuswidget.js" role="article"><div class="tc-tiddler-title"><div class="tc-titlebar"><span class="tc-tiddler-controls"><button aria-label="trashbin" class="tc-btn-invisible tc-btn-%24%3A%2Fplugins%2Fkookma%2Ftrashbin%2Fui%2Ftoolbar-button" title="Move this tiddler to Trashbin"> 
























</button><button aria-expanded="false" aria-label="more" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fmore-tiddler-actions" title="More actions"></button><div class=" tc-reveal" hidden="true"></div><button aria-label="favorites" class="tc-btn-invisible tc-btn-%24%3A%2Fplugins%2Fkookma%2Ffavorites%2Fui%2Fbuttons%2Fadd-remove" title="Add to favorites">
     
		 

		 
 </button><button aria-label="close others" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fclose-others" title="Close other tiddlers"></button><span class=" tc-reveal"><button aria-label="fold tiddler" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Ffold" title="Fold the body of this tiddler"></button></span><span class=" tc-reveal" hidden="true"></span><button class="tc-btn-invisible tc-btn-neotw%2Fviewbar%2Fcopy-title" title="copy current title"></button><button aria-label="edit" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fedit" title="Edit this tiddler"></button><button class="tc-btn-invisible tc-btn-neotw%2Fcopy-text" title="copy current code"></button><button aria-label="close" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fclose" title="Close this tiddler"></button></span><span><h2 class="tc-title">neotw/giscuswidget.js</h2></span></div><div class="tc-tiddler-info tc-popup-handle tc-reveal" hidden="true"></div></div><div class=" tc-reveal" hidden="true"></div>
<div class=" tc-reveal"><div class="tc-subtitle"><span class="neotw-arrowright"></span><a class="tc-tiddlylink tc-tiddlylink-resolves" href="oeyoews.html">oeyoews</a><span class="neotw-dot-status"></span>Created 2022/09/06 <span class="neotw-edit"></span>Updated 2022/09/10 15:15 </div></div><div class=" tc-reveal">
<div class="tc-tags-wrapper sq-view-tags-wrapper tc-reveal"><button class="tc-btn-invisible" title="add tags"><svg class="tc-image-new-here-button tc-image-button" height="22pt" viewBox="0 0 128 128" width="22pt"><g fill-rule="evenodd"><path d="M55.838 20.935l-3.572.938c-3.688.968-8.23 4.43-10.136 7.731L3.37 96.738c-1.905 3.3-.771 7.524 2.534 9.432l33.717 19.466c3.297 1.904 7.53.78 9.435-2.521l38.76-67.134c1.905-3.3 2.632-8.963 1.623-12.646L83.285 20.88c-1.009-3.68-4.821-5.884-8.513-4.915l-7.603 1.995.043.287c.524 3.394 2.053 7.498 4.18 11.55.418.163.829.36 1.23.59a8.864 8.864 0 014.438 8.169c.104.132.21.264.316.395l-.386.318a8.663 8.663 0 01-1.082 3.137c-2.42 4.192-7.816 5.608-12.051 3.163-4.12-2.379-5.624-7.534-3.476-11.671-2.177-4.394-3.788-8.874-4.543-12.964z"></path><path d="M69.554 44.76c-5.944-7.476-10.74-17.196-11.955-25.059-1.68-10.875 3.503-18.216 15.082-18.04 10.407.158 19.975 5.851 24.728 13.785 5.208 8.695 2.95 17.868-6.855 20.496l-2.037-7.601c4.232-1.134 4.999-4.248 2.24-8.853-3.37-5.626-10.465-9.848-18.146-9.965-6.392-.097-8.31 2.62-7.323 9.01.999 6.465 5.318 15.138 10.582 21.65l-.072.06c.559 1.553-4.17 6.44-5.938 4.888l-.005.004-.028-.034a1.323 1.323 0 01-.124-.135 2.618 2.618 0 01-.149-.205z"></path><rect height="48" rx="8" width="16" x="96" y="80"></rect><rect height="16" rx="8" width="48" x="80" y="96"></rect></g></svg></button></div>
<div class="tc-tags-wrapper sq-edit-tags-wrapper tc-reveal" hidden="true"></div>
</div>



<div class="tc-tiddler-body tc-reveal"><pre class="hljs"><code class="javascript hljs">(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
    <span class="hljs-string">&quot;use strict&quot;</span>;
    <span class="hljs-keyword">var</span> <span class="hljs-title class_">Widget</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;$:/core/modules/widgets/widget.js&quot;</span>).<span class="hljs-property">widget</span>;
    <span class="hljs-keyword">var</span> <span class="hljs-title class_">GiscusNodeWidget</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">parseTreeNode, options</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initialise</span>(parseTreeNode, options);
    };
    <span class="hljs-title class_">GiscusNodeWidget</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Widget</span>();
    <span class="hljs-title class_">GiscusNodeWidget</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">render</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">parent, nextSibling</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentDomNode</span> = parent;
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">computeAttributes</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">execute</span>();
        <span class="hljs-keyword">var</span> id = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-string">&quot;&quot;</span>);
        <span class="hljs-keyword">var</span> lang = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&quot;lang&quot;</span>, <span class="hljs-string">&quot;en&quot;</span>);
        <span class="hljs-keyword">var</span> theme = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&quot;theme&quot;</span>, <span class="hljs-string">&quot;light&quot;</span>);
        <span class="hljs-keyword">if</span> (id === <span class="hljs-string">&#x27;&#x27;</span>) <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">var</span> scriptNode = <span class="hljs-variable language_">this</span>.<span class="hljs-property">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;script&#x27;</span>);
        scriptNode.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&quot;src&quot;</span>, <span class="hljs-string">&quot;https://giscus.app/client.js&quot;</span>);
        scriptNode.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&quot;data-repo&quot;</span>, <span class="hljs-string">&quot;oeyoews/neotw&quot;</span>);
        scriptNode.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&quot;data-repo-id&quot;</span>, <span class="hljs-string">&quot;R_kgDOH5A5OA&quot;</span>);
        scriptNode.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&quot;data-category&quot;</span>, <span class="hljs-string">&quot;General&quot;</span>);
        scriptNode.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&quot;data-category-id&quot;</span>, <span class="hljs-string">&quot;DIC_kwDOH5A5OM4CRFEE&quot;</span>);
        scriptNode.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&quot;data-mapping&quot;</span>, <span class="hljs-string">&quot;specific&quot;</span>);
        scriptNode.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&quot;data-term&quot;</span>, <span class="hljs-string">&quot;GettingStarted&quot;</span>);
        scriptNode.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&quot;data-reactions-enabled&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>);
        scriptNode.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&quot;data-emit-metadata&quot;</span>, <span class="hljs-string">&quot;0&quot;</span>);
        scriptNode.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&quot;data-theme&quot;</span>, theme);
        scriptNode.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&quot;data-lang&quot;</span>, lang);
        scriptNode.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&quot;crossorigin&quot;</span>, <span class="hljs-string">&quot;anonymous&quot;</span>);
        scriptNode.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&quot;async&quot;</span>, <span class="hljs-string">&quot;true&quot;</span>);
        <span class="hljs-comment">// Clear other comment nodes&#x27; giscus class</span>
        <span class="hljs-keyword">var</span> commentNodes = <span class="hljs-variable language_">this</span>.<span class="hljs-property">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;.giscus&#x27;</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, len = commentNodes.<span class="hljs-property">length</span>; i &lt; len; i++) {
            commentNodes[i].<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">&#x27;giscus&#x27;</span>);
        }
        <span class="hljs-comment">// Find or create</span>
      <span class="hljs-keyword">var</span> commentNode = <span class="hljs-variable language_">this</span>.<span class="hljs-property">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;.gk0wk-giscus[tiddler-title=&quot;&#x27;</span> + id.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;\\&quot;&#x27;</span>) + <span class="hljs-string">&#x27;&quot;]&#x27;</span>);
      <span class="hljs-keyword">if</span> (!commentNode) {
        commentNode = <span class="hljs-variable language_">this</span>.<span class="hljs-property">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>);
        commentNode.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&#x27;class&#x27;</span>, <span class="hljs-string">&#x27;giscus gk0wk-giscus&#x27;</span>);
        commentNode.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&#x27;tiddler-title&#x27;</span>, id);
        parent.<span class="hljs-title function_">insertBefore</span>(commentNode, nextSibling);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">domNodes</span>.<span class="hljs-title function_">push</span>(commentNode);
      }
        parent.<span class="hljs-title function_">insertBefore</span>(scriptNode, nextSibling);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">domNodes</span>.<span class="hljs-title function_">push</span>(scriptNode);
    };
    <span class="hljs-title class_">GiscusNodeWidget</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">execute</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {};
    <span class="hljs-title class_">GiscusNodeWidget</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">refresh</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
        <span class="hljs-keyword">var</span> changedAttributes = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">computeAttributes</span>();
        <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(changedAttributes).<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">refreshSelf</span>();
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    };
    <span class="hljs-built_in">exports</span>.<span class="hljs-property">giscus</span> = <span class="hljs-title class_">GiscusNodeWidget</span>;
})();</code></pre></div>
<div class=" tc-reveal">

</div>
</div></p>
</section>
</body>
</html>

