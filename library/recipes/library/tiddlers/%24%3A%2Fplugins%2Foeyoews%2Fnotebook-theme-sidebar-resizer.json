{"title":"$:/plugins/oeyoews/notebook-theme-sidebar-resizer","description":"notebook-theme-sidebar-resizer","author":"oeyoews","version":"0.0.1","core-version":">=5.3.1","type":"application/json","plugin-type":"plugin","name":"notebook-theme-sidebar-resizer","meat#disabled":"yes","qrcode":"yes","dependents":"$:/plugins/oeyoews/tiddlywiki-tailwindcss-plus","list":"readme","text":"{\"tiddlers\":{\"$:/plugins/oeyoews/notebook-theme-sidebar-resizer/readme\":{\"title\":\"$:/plugins/oeyoews/notebook-theme-sidebar-resizer/readme\",\"text\":\"<!-- plugin template readme -->\\n\",\"type\":\"text/markdown\",\"description\":\"notebook-theme-sidebar-resizer\"},\"$:/plugins/oeyoews/notebook-theme-sidebar-resizer/widget.js\":{\"title\":\"$:/plugins/oeyoews/notebook-theme-sidebar-resizer/widget.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/notebook-theme-sidebar-resizer/widget.js\\ntype: application/javascript\\nmodule-type: widget\\n\\nnotebook-theme-sidebar-resizer widget\\n\\n\\\\*/\\nconst { widget: Widget } = require('$:/core/modules/widgets/widget.js');\\n// TODO: support left or right\\n\\nclass NotebookResizer extends Widget {\\n  constructor(parseTreeNode, options) {\\n    super(parseTreeNode, options);\\n    this.isResizing = false;\\n    this.tiddler = '$:/themes/nico/notebook/metrics/sidebar-width';\\n  }\\n\\n  render(parent, nextSibling) {\\n    if (!$tw.browser) return;\\n    this.parentDomNode = parent;\\n    this.computeAttributes();\\n    this.execute();\\n\\n    const createElement = $tw.utils.domMaker;\\n\\n    const resizer = createElement('div', {\\n      class:\\n        'hover:cursor-ew-resize hover:bg-gray-200 rounded-full transition-all h-full w-[6px] absolute top-0 right-0',\\n      // attributes: { id: 'om-resizer' },\\n    });\\n\\n    // let width = $tw.wiki.getTiddlerText(this.tiddler).replace('px', '');\\n\\n    // TODO: support reset sidebar width\\n    resizer.addEventListener('pointerdown', (e) => {\\n      this.isResizing = true;\\n      e.preventDefault(); // 阻止默认的文本选择行为\\n      document.addEventListener('pointermove', resize);\\n\\n      document.addEventListener('pointerup', stopResize);\\n    });\\n\\n    const resize = (e) => {\\n      // TODO: throttle requestanimation\\n      if (this.isResizing) {\\n        // TODO: use percent\\n        if (e.clientX > 750 || e.clientX < 250) {\\n          return;\\n        }\\n        this.updateSidebarWidth(e.clientX);\\n      }\\n    };\\n\\n    const stopResize = () => {\\n      this.isResizing = false;\\n      document.removeEventListener('pointermove', resize);\\n    };\\n\\n    parent.insertBefore(resizer, nextSibling);\\n    this.domNodes.push(resizer);\\n  }\\n\\n  updateSidebarWidth(width) {\\n    requestAnimationFrame(() => {\\n      $tw.wiki.setText(this.tiddler, null, null, `${width}px`);\\n    });\\n  }\\n\\n  refresh() {\\n    return false;\\n  }\\n}\\n\\n/**\\n * @description notebook-theme-sidebar-resizer widget\\n */\\nexports.nbresizer = NotebookResizer;\\n\",\"type\":\"application/javascript\",\"module-type\":\"widget\"}}}"}