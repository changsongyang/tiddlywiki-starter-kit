{"title":"$:/plugins/oeyoews/neotw-copy-code","description":"Neotw Copy Code","author":"oeyoews","version":"0.0.1","core-version":">=5.2.5","type":"application/json","plugin-type":"plugin","name":"Neotw Copy Code","dependents":"$:/plugins/oeyoews/tiddlywiki-tailwindcss-plus","list":"readme explore","text":"{\"tiddlers\":{\"demo.min.js\":{\"text\":\"\\n\",\"title\":\"demo.min.js\",\"module-type\":\"library\",\"type\":\"application/javascript\",\"hide-body\":\"yes\"},\"$:/plugins/oeyoews/neotw-copy-code/readme\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/readme\",\"text\":\"!! Neotw Copy Code\\n\\n* [[Source|https://github.com/oeyoews/neotw/tree/main/plugins/oeyoews/neotw-copy-code]]\\n* [[Demo|https://oeyoews.github.io/neotw]]\\n\\n!! TODO\\n\\n* update copied icon\\n* update style for button\\n* add viewtoolbar not pagecontrol\\n* add hover style\\n* support hover scroll for code preview\\n* add transform style\\n\\n!! Example\\n\\n```lua\\nlocal M = {}\\n```\\n\"},\"$:/plugins/oeyoews/neotw-copy-code/copyCode.js\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/copyCode.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/oeyoews/neotw-copy-code/copyCode.js\\ntype: application/javascript\\nmodule-type: library\\n\\nneotw-copy-code widget\\n\\n\\\\*/\\nfunction addCopyButton() {\\n  const codeBlocks = document.querySelectorAll('pre');\\n\\n  codeBlocks.forEach(codeBlock => {\\n    const existingButton = codeBlock.querySelector('.copy-button');\\n    const codeElement = codeBlock.querySelector('code');\\n    // ??\\n    if (existingButton && codeElement) {\\n      existingButton.remove();\\n    } else {\\n      const copyButton = document.createElement('button');\\n      copyButton.title = 'Copy code';\\n      copyButton.textContent = 'ðŸ“‹ Copy';\\n      copyButton.classList.add(\\n        'copy-button',\\n        'float-right',\\n        'hover:bg-gray-200',\\n      );\\n      copyButton.addEventListener('click', () => {\\n        const range = document.createRange();\\n        range.selectNode(codeElement);\\n        window.getSelection().removeAllRanges();\\n        window.getSelection().addRange(range);\\n        const isSuccess = document.execCommand('copy');\\n        window.getSelection().removeAllRanges();\\n        if (isSuccess) {\\n          confetti();\\n          const copiedCode = range.toString();\\n          const copiedCodeNode = document.createElement('pre');\\n          copiedCodeNode.textContent = copiedCode;\\n          copiedCodeNode.classList.add(\\n            'bg-gray-100',\\n            'p-2',\\n            'rounded',\\n            'text-base',\\n            'font-mono',\\n            'leading-relaxed',\\n            'text-left',\\n            'overflow-x-auto',\\n            'whitespace-pre-wrap',\\n            'border',\\n            'border-none',\\n            'break-words',\\n          );\\n          swal({\\n            title: 'Copied to clipboard',\\n            content: copiedCodeNode,\\n            icon: 'success',\\n            timer: 5000,\\n          });\\n        } else {\\n          swal('Copy failed', '', 'error');\\n        }\\n      });\\n      if (codeElement) {\\n        codeElement.parentNode.insertBefore(copyButton, codeElement);\\n      }\\n    }\\n  });\\n}\\n\\nexports.addCopyButton = addCopyButton;\\n\",\"type\":\"application/javascript\",\"module-type\":\"library\"},\"$:/plugins/oeyoews/neotw-copy-code/icon\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/icon\",\"text\":\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" fill=\\\"none\\\" viewBox=\\\"0 0 24 24\\\" stroke-width=\\\"1.5\\\" stroke=\\\"currentColor\\\" class=\\\"w-6 h-6 text-gray-500 hover:text-gray-700\\\">\\n  <path stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" d=\\\"M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184\\\" />\\n</svg>\\n\",\"type\":\"image/svg+xml\"},\"$:/plugins/oeyoews/neotw-copy-code/snippets/neotw-copy-code\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/snippets/neotw-copy-code\",\"caption\":\"neotw-copy-code Widget\",\"description\":\"Neotw Copy Code Widget\",\"tags\":\"$:/tags/TextEditor/Snippet\"},\"copyButton/startup.js\":{\"title\":\"copyButton/startup.js\",\"text\":\"/*\\\\\\ntitle: copyButton/startup.js\\ntype: application/javascript\\nmodule-type: startup\\n\\ncopyButton module\\n\\n\\\\*/\\n(function() {\\n  /*jslint node: true, browser: true */\\n  /*global $tw: false */\\n  'use strict';\\n\\n  exports.name = 'copyButton-startup-hook';\\n  exports.platforms = ['browser'];\\n  exports.after = ['load-modules'];\\n  exports.synchronous = true;\\n  exports.startup = () => {\\n    const {\\n      addCopyButton,\\n    } = require('$:/plugins/oeyoews/neotw-copy-code/copyCode.js');\\n    // window.copyButton = addCopyButton;\\n    $tw.rootWidget.addEventListener('om-copy-code', () => {\\n      addCopyButton();\\n    });\\n  };\\n})();\\n\",\"type\":\"application/javascript\",\"module-type\":\"startup\"},\"$:/plugins/oeyoews/neotw-copy-code/ui\":{\"title\":\"$:/plugins/oeyoews/neotw-copy-code/ui\",\"tags\":\"$:/tags/PageControls\",\"list-before\":\"\",\"description\":\"copy code button\",\"caption\":\"Copy Button\",\"text\":\"\\\\whitespace trim\\n<$button message=\\\"om-copy-code\\\" tooltip=\\\"\\\" aria-label=\\\"\\\" class=<<tv-config-toolbar-class>>>\\n<$action-sendmessage $message=\\\"om-confetti-launch\\\"/>\\n<$list filter=\\\"[<tv-config-toolbar-icons>match[yes]]\\\">\\n{{$:/plugins/oeyoews/neotw-copy-code/icon}}\\n</$list>\\n<$list filter=\\\"[<tv-config-toolbar-text>match[yes]]\\\">\\n<span class=\\\"tc-btn-text\\\">\\n<$text text=\\\"\\\"/>\\n</span>\\n</$list>\\n</$button>\\n\"}}}"}