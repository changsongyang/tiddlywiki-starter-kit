{"title":"$:/plugins/oeyoews/neotw-links-gallery","description":"neotw-links-gallery","author":"oeyoews","version":"0.0.1","core-version":">=5.3.0","type":"application/json","plugin-type":"plugin","name":"neotw-links-gallery","dependents":"$:/plugins/oeyoews/tiddlywiki-tailwindcss-plus","list":"readme","text":"{\"tiddlers\":{\"$:/plugins/oeyoews/neotw-links-gallery/readme\":{\"title\":\"$:/plugins/oeyoews/neotw-links-gallery/readme\",\"text\":\"## TODO\\r\\n\\r\\n* add quickadd links button on widget\\r\\n- [ ] add description links order for table\\r\\n- [ ] support revese\",\"type\":\"text/markdown\",\"description\":\"neotw-links-gallery\"},\"$:/plugins/oeyoews/neotw-links-gallery/widget.js\":{\"title\":\"$:/plugins/oeyoews/neotw-links-gallery/widget.js\",\"text\":\"/*\\\\\\r\\ntitle: $:/plugins/oeyoews/neotw-links-gallery/widget.js\\r\\ntype: application/javascript\\r\\nmodule-type: widget\\r\\n\\r\\nneotw-links-gallery widget\\r\\n\\r\\n\\\\*/\\r\\n\\r\\nconst { widget: Widget } = require('$:/core/modules/widgets/widget.js');\\r\\n\\r\\nclass ListlinksWidget extends Widget {\\r\\n  constructor(parseTreeNode, options) {\\r\\n    super(parseTreeNode, options);\\r\\n  }\\r\\n\\r\\n  render(parent, nextSibling) {\\r\\n    this.parentDomNode = parent;\\r\\n    this.computeAttributes();\\r\\n    this.execute();\\r\\n\\r\\n    const createElement = $tw.utils.domMaker;\\r\\n    const { json = 'list-links.json' } = this.attributes;\\r\\n    const { caption } = $tw.wiki.getTiddler(json).fields || {};\\r\\n    const isStoryRiver = this.getVariable('storyTiddler') !== undefined;\\r\\n    console.log(isStoryRiver, 'xx');\\r\\n\\r\\n    const data = $tw.wiki.getTiddlerData(json) || {};\\r\\n    const linksURL = Object.entries(data);\\r\\n\\r\\n    let linkcount = 0;\\r\\n    const createTableData = (text, href, order) => {\\r\\n      const tr = this.document.createElement('tr');\\r\\n      const orderNode = this.document.createElement('td');\\r\\n      const descriptionNode = this.document.createElement('td');\\r\\n      const linkNode = this.document.createElement('td');\\r\\n      if (!href.startsWith('http')) return;\\r\\n\\r\\n      try {\\r\\n        const { protocol, hostname } = new URL(href);\\r\\n        const url = `${protocol}//${hostname}`;\\r\\n        const createLinkNode = (text, href) =>\\r\\n          createElement('a', {\\r\\n            text: hostname,\\r\\n            attributes: {\\r\\n              href,\\r\\n              title: url,\\r\\n              target: '_blank',\\r\\n            },\\r\\n          });\\r\\n\\r\\n        descriptionNode.className =\\r\\n          'p-2 bg-gray-200 dark:bg-black font-bold capitalize';\\r\\n        linkNode.className = 'p-2 bg-gray-200 dark:bg-black font-bold';\\r\\n        descriptionNode.textContent = text;\\r\\n        orderNode.textContent = order;\\r\\n        orderNode.className =\\r\\n          'font-bold bg-gray-100 dark:bg-black group-hover:bg-gray-300 group-hover:dark:bg-gray-800 transiton';\\r\\n        const children = [descriptionNode, linkNode];\\r\\n        isStoryRiver && children.unshift(orderNode);\\r\\n        tr.append(...children);\\r\\n\\r\\n        tr.className = 'group';\\r\\n        linkNode.append(createLinkNode(text, href));\\r\\n      } catch (e) {\\r\\n        console.warn(e);\\r\\n      }\\r\\n      return tr;\\r\\n    };\\r\\n\\r\\n    const createThNode = (caption) => {\\r\\n      const tr = this.document.createElement('tr');\\r\\n      const orderNode = this.document.createElement('th');\\r\\n      const descriptionNode = this.document.createElement('th');\\r\\n      const linkNode = this.document.createElement('th');\\r\\n\\r\\n      const children = [orderNode, descriptionNode, linkNode];\\r\\n      tr.append(...children);\\r\\n\\r\\n      orderNode.textContent = 'Order';\\r\\n      descriptionNode.textContent = 'Description';\\r\\n      linkNode.textContent = 'Link';\\r\\n      tr.className = 'font-bold capitalize';\\r\\n      return tr;\\r\\n    };\\r\\n\\r\\n    const children = [];\\r\\n\\r\\n    linksURL.forEach(([text, href]) => {\\r\\n      linkcount++;\\r\\n      children.push(createTableData(text, href, linkcount));\\r\\n    });\\r\\n\\r\\n    isStoryRiver && children.unshift(createThNode(caption));\\r\\n\\r\\n    const domNode = createElement('table', {\\r\\n      children,\\r\\n    });\\r\\n\\r\\n    parent.insertBefore(domNode, nextSibling);\\r\\n    this.domNodes.push(domNode);\\r\\n  }\\r\\n}\\r\\n\\r\\n/**\\r\\n * @description\\r\\n * @param {json}\\r\\n */\\r\\nexports['list-links'] = ListlinksWidget;\\r\\n\",\"type\":\"application/javascript\",\"module-type\":\"widget\"}}}"}